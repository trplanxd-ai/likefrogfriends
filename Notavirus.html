<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Not a virus, I promise</title>
    <!-- Li√™n k·∫øt ƒë·∫øn file CSS ri√™ng bi·ªát -->
    <link rel="stylesheet" href="style.css">
    
    <!-- CSS n·ªôi tuy·∫øn cho c√°c ph·∫ßn t·ª≠ game m·ªõi -->
    <style>
        /* ·∫®n khung game v√† k·∫øt qu·∫£ ban ƒë·∫ßu */
        #gameAreaVal, #resultVal, #highScoreVal { /* Th√™m highScoreVal v√†o ƒë√¢y ƒë·ªÉ qu·∫£n l√Ω hi·ªÉn th·ªã */
            display: none; 
        }

        /* ƒê·ªãnh nghƒ©a k√≠ch th∆∞·ªõc, m√†u n·ªÅn cho khung game khi n√≥ hi·ªán ra */
        #gameAreaVal {
            height: 300px; 
            background-color: #eee;
            border: 2px solid #ccc;
            margin-top: 10px;
            position: relative;
            overflow: hidden;
        }
        
        /* ƒê·ªãnh ki·ªÉu cho c√°c th√¥ng b√°o con b√™n trong gameAreaVal */
        .notification {
            position: absolute;
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            transition: opacity 0.3s ease-out;
            opacity: 1;
            z-index: 10;
            font-size: 0.8em;
            width: 120px; 
            text-align: center;
        }

        .notification.hidden {
            opacity: 0;
            pointer-events: none;
        }
    </style>
</head>

<body>

    <!-- TARGET SECTIONS -->
    <div id="val" class="content">
        <b>Val</b>: calm, collected, and suspiciously quiet.
        <!-- N·ªòI DUNG GAME M·ªöI ƒê∆Ø·ª¢C TH√äM V√ÄO ƒê√ÇY -->
        <hr style="margin: 10px 0;">
        
        <!-- N√∫t B·∫Øt ƒë·∫ßu game -->
        <button onclick="startGameVal()"><p style="color: red">Feel my</p> <b style="color:#2eb033; font-family:monospace">ENTANGLEMENT!</b></button>
        
        <!-- HI·ªÇN TH·ªä K·ª∂ L·ª§C C√Å NH√ÇN -->
        <p id="highScoreVal" style="margin-top: 10px; font-weight: bold; color: blue;"></p>

        <!-- KHU V·ª∞C CH∆†I GAME (·∫®n ban ƒë·∫ßu, ch·ªâ hi·ªán khi nh·∫•n n√∫t) -->
        <div id="gameAreaVal"></div>
        
        <!-- KHU V·ª∞C K·∫æT QU·∫¢ (·∫®n ban ƒë·∫ßu, ch·ªâ hi·ªán khi nh·∫•n n√∫t) -->
        <p id="resultVal"></p>
    </div>

    <div id="chiek" class="content">
        <b>Chiek</b>: energetic, chaotic, I think? KIMBUST KOMPANY
    </div>

    <div id="jessie" class="content">
        <b>Jessie</b>: A gambler who screamming and yapping a lot <b style="color:Purple; font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif; ">[Unlucky Gambler]</b>
        <br><br>
        <button class="luck-btn" onclick="luckTest()">Try your luck</button>
        <p id="result-display" style="margin-top:15px; font-weight:bold;"></p>
    </div>

    <div id="mint" class="content">
        <b>Mint</b>: Just a silly clown who <b style="color:RED; font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;">EMBRACE SILLINESS</b>
    </div>

    <!-- QUESTION -->
    <h1 id="question1" class="write">Who are you?</h1>

    <!-- BUTTONS -->
    <div class="friends">
        <a class="btn" href="#val">Val</a>
        <a class="btn" href="#chiek">Chiek</a>
        <a class="btn" href="#jessie">Jessie</a>
        <a class="btn" href="#mint">Mint</a>
    </div>

    <!-- BACKGROUND (PH·∫¢I ƒê·ªÇ CU·ªêI FILE) -->
    <div id="bg"></div>
    
    <script>
        // --- JAVASCRIPT CHO GAME C·ª¶A VAL ---
        const gameAreaVal = document.getElementById('gameAreaVal');
        const resultValArea = document.getElementById('resultVal');
        const highScoreValArea = document.getElementById('highScoreVal'); // Get record element
        let startTimeVal;
        let notificationsCountVal = 0;
        const TOTAL_NOTIFICATIONS_VAL = 5;
        const NOTIF_WIDTH = 140;
        const NOTIF_HEIGHT = 70;

        // DANH S√ÅCH N·ªòI DUNG TH√îNG B√ÅO NG·∫™U NHI√äN
        const NOTIFICATION_CONTENTS = [
            "JESSIE",
            "MINT",
            "Val is watching",
            "CHIEK",
            "Forsaken?",
            "wdym?",
            "TRUD!",
            "...",
            "1 EGG!"
        ];

        function getRandom(min, max) {
            return Math.random() * (max - min) + min;
        }

        function dismissNotification(event) {
            const notif = event.target;
            notif.classList.add('hidden'); 
            
            notificationsCountVal++;

            if (notificationsCountVal === TOTAL_NOTIFICATIONS_VAL) {
                endGameVal();
            }
        }

        function startGameVal() {
            // SHOW GAME AREA AND RESULT AREA WHEN CLICKING THE BUTTON
            gameAreaVal.style.display = 'block'; 
            resultValArea.style.display = 'block';
            highScoreValArea.style.display = 'block'; // Ensure record also shows
            
            gameAreaVal.innerHTML = ''; // Clear old notifications
            resultValArea.textContent = 'Playing...';
            notificationsCountVal = 0;
            startTimeVal = Date.now(); // Start timer

            // Create notifications using random content list
            for (let i = 0; i < TOTAL_NOTIFICATIONS_VAL; i++) {
                createNotificationVal(); // Call without ID
            }
        }

        function createNotificationVal() {
            const notif = document.createElement('div');
            
            // SELECT RANDOM CONTENT FROM ARRAY
            const randomIndex = Math.floor(Math.random() * NOTIFICATION_CONTENTS.length);
            notif.textContent = NOTIFICATION_CONTENTS[randomIndex];

            notif.classList.add('notification');
            notif.onclick = dismissNotification;

            // Calculate random position without overflowing
            const areaWidth = gameAreaVal.offsetWidth - NOTIF_WIDTH;
            const areaHeight = gameAreaVal.offsetHeight - NOTIF_HEIGHT;
            
            notif.style.left = `${getRandom(0, areaWidth)}px`;
            notif.style.top = `${getRandom(0, areaHeight)}px`;

            gameAreaVal.appendChild(notif);
        }

        function endGameVal() {
            const endTime = Date.now();
            const timeTaken = (endTime - startTimeVal) / 1000;
            resultValArea.innerHTML = `üéâ Escape entanglement in **${timeTaken.toFixed(2)} sec** üéâ`;
            
            // LOGIC TO SAVE NEW HIGH SCORE TO LOCALSTORAGE
            const highScore = parseFloat(localStorage.getItem("val_highscore") || "999999"); 
            
            if (timeTaken < highScore) {
                localStorage.setItem("val_highscore", timeTaken.toFixed(2)); 
                alert(`üéä Your new record! ${timeTaken.toFixed(2)} sec!`);
            }
            
            updateHighScoreVal(); // Update the display of the high score after playing
        }

        // FUNCTION TO UPDATE HIGH SCORE DISPLAY
        function updateHighScoreVal() {
            const highScore = localStorage.getItem("val_highscore");
            if (highScore) {
                highScoreValArea.textContent = `Personal record: ${highScore} sec`;
            } else {
                highScoreValArea.textContent = `No record yet`;
            }
        }



        // --- JAVASCRIPT G·ªêC CHO JESSIE (GAME X√öC X·∫ÆC) ---
        const romanMapExtended = [ [1000, "M"], [900, "CM"], [500, "D"], [400, "CD"], [100, "C"], [90, "XC"], [50, "L"], [40, "XL"], [10, "X"], [9, "IX"], [5, "V"], [4, "IV"], [1, "I"] ];
        function integerToRoman(num) { 
            if (num < 1 || num > 3999) { return num.toString(); }
            let result = '';
            for (const [value, symbol] of romanMapExtended) {
                while (num >= value) { result += symbol; num -= value; }
            }
            return result;
        }
        function luckTest() {
            let r = Math.random() < 0.5 ? 1 : 2;
            let win = parseInt(localStorage.getItem("jessie_win") || "0");
            let lose = parseInt(localStorage.getItem("jessie_lose") || "0");
            if (r === 1) {
                win++; localStorage.setItem("jessie_win", win); alert("üéâ Heads");
            } else {
                lose++; localStorage.setItem("jessie_lose", lose); alert("üòî Tails");
            }
            updateDisplay();
        }
        function updateDisplay() {
            let win = localStorage.getItem("jessie_win") || 0;
            let lose = localStorage.getItem("jessie_lose") || 0;
            const loseRoman = integerToRoman(lose); 
            document.getElementById("result-display").innerText = win + " Heads ‚Äî " + "Weakness " + loseRoman;
        }
        
        // G·ªçi h√†m c·∫≠p nh·∫≠t hi·ªÉn th·ªã khi t·∫£i trang
        updateDisplay(); 
        updateHighScoreVal(); // G·ªçi h√†m c·∫≠p nh·∫≠t k·ª∑ l·ª•c Val khi t·∫£i trang l·∫ßn ƒë·∫ßu
    </script>

</body>
</html>

